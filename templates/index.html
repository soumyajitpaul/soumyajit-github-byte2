<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">
    <title>Lost in 8000 Meters!!</title>
    
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="css/bootstrap-theme.min.css" rel="stylesheet">
    <!-- Custom styles for this project -->
    <link href="css/explore.css" rel="stylesheet">
  </head>
  
  <body role="document">
    
    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container" >
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="about">About-Data Set</a></li>
	    <li><a href="quality">Cleaning Procedure</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
    
    <div class="container theme-showcase" role="main">
      
      <!-- Main jumbotron for a primary marketing message or call to action -->
      <div class="jumbotron">
	<h1>Missing Climbers - Mount Everest</h1>
         
         <p>INTRODUCTION:
         <br>
         
         Mount Everest, at 8,848 metres (29,029 ft) is the world's highest mountain and a particularly desirable peak for mountaineers. 
         Over 280 people have died trying to climb it and in the last few decades, fatalities have occurred every year. 
         <br>
         
         <center><img width="750" height="250" src="/img/Byte_2_Image_7.jpg" alt="Density of death records_Heat Map"></center>
         
         <br>
         
         The last year without known fatalities on the mountain was 1977, a year in which only two people reached the summit.
         Most deaths have been attributed to avalanches, injury from fall, ice collapse, exposure, or health problems related to conditions on the mountain.
         Not all bodies have been located, so details on those fatalities are not available.
         </p>
         
         <p>
        <br>
        This web-page shows the extraction of data of missing climbers in Mount Everest Expedition, 
        using data cleaning procedure to qualify our search. <br> The first  table shows the raw data collected from Google fusuion tables </p>
        <iframe width="1000" height="300" scrolling="yes" frameborder="no" src="https://fusiontables.google.com/embedviz?viz=CARD&amp;q=select+*+from+1_-7pYmyq3_ilQB_fJZvnRJ81ghf7cBmdGMXu2P1k&amp;tmplt=1&amp;cpr=2"></iframe>
        
        <P>
       	<br>
       	
       	The chart below provides a nodal map of country versus the name of the climbers.</b> This also represents the death counts in terms of magnitude and the respective country </p>
        <iframe width="500" height="300" scrolling="no" frameborder="no" src="https://fusiontables.google.com/embedviz?containerId=googft-gviz-canvas&amp;viz=GVIZ&amp;t=GRAPH&amp;gc=true&amp;gd=true&amp;sdb=1&amp;rmax=100000&amp;uiversion=2&amp;q=select+col0%2C+col4+from+1_-7pYmyq3_ilQB_fJZvnRJ81ghf7cBmdGMXu2P1k&amp;qrs=+where+col0+%3E%3D+&amp;qre=+and+col0+%3C%3D+&amp;qe=&amp;state=%7B%22ps%22%3A%221_f_-7_-1z_w_-36_1s_d_-84_u_h_-8n_-5e_15_49_-29_11_-6h_-27_6_-3d_-5u_8_2m_-5g_l_-54_-1g_1b_-1j_-30_23_1i_2a_4_-4p_-40_1z_1e_-69_2o_-35_-3a_1_-4l_-a_1v_-36_3f_17_-1a_-2f_1n_-k_-v_25_-18_-1d_29_a_-w_2i_x_-1n_e_-1h_-x_b_5y_-3u_0_-5c_15_c_-6u_-7_s_-1m_-15_q_-6i_12_5_-1q_-5z_1f_-1r_-5i_2_-4f_-1x_7_12_-5u_1e_-1q_-1e_1c_-d_-c_r_-b_-3l_i_-r_-3i_13_-1t_-1m_1p_-1p_-2m_24_-17_-3a_3_-44_-2i_j_-8d_-40_10_-6w_-3r_x_-45_i_y_-4d_10_19_2k_2j_1l_5k_-1b_1y_-8_-64_1k_-1s_-2d_g_-72_-4y_v_-4q_1d_z_12_-30_1g_-v_-h_1j_-1u_-1v_1m_-z_-3e_1x_10_-u_21_5_-d_27_d_-f_2d_r_-3b_1o_-5s_-4z_12_-62_-n_14_4i_-3v_28_-j_-3k_9_10_-5d_a_5j_-37_k_-5n_-2z_m_17_-2t_n_-3_-3l_o_-7d_-66_p_-53_-32_t_-1u_-6f_u_1b_-2m_16_-81_-2g_18_3i_2b_1a_t_-o_1d_1f_-26_1h_c_-3i_1i_-2d_-6a_1q_-13_-l_1r_-1a_-r_1s_x_-36_1t_1d_-1h_1u_-1n_2v_1w_19_-18_20_1f_-1p_22_2n_15_26_-4_-c_2a_-7u_-s_2b_-71_-5k_2c_30_1o_2e_m_-j_2f_1d_-2e_2g_k_-3f_2h_1g_-1y_2j_-m_-e_2k_5_-3k_2l_-1u_-24_2m_-1k_3m_2n_15_-11_%22%2C%22cx%22%3A-10.343189833840507%2C%22cy%22%3A-77.7109376099193%2C%22sw%22%3A1587.4814705498177%2C%22sh%22%3A555.2918724145453%2C%22z%22%3A-0.0009209979076395752%7D&amp;gco_forceIFrame=true&amp;gco_hasLabelsColumn=true&amp;width=500&amp;height=300"></iframe>
        <iframe width="500" height="300" scrolling="no" frameborder="no" src="https://fusiontables.google.com/embedviz?q=select+col4+from+1_-7pYmyq3_ilQB_fJZvnRJ81ghf7cBmdGMXu2P1k&amp;viz=MAP&amp;h=false&amp;lat=34.24035973959789&amp;lng=27.42236024999998&amp;t=1&amp;z=2&amp;l=col4&amp;y=2&amp;tmplt=3&amp;hml=GEOCODABLE"></iframe>
        
        <p>
        <br>
        
        The Heat map reflects the density of deaths recorded nationality wise.<br> It can be seen that the registered nationality 
        of death count has the maximum count from Nepal and then is spread across the world. From this dataset, we can even infer that people across the globe 
        has tried for an expedition to Mt. Everest over the years
        <br> 
        </p> 
        <center><img width="750" height="250" src="/img/Byte_2_Image_3.png" alt="Density of death records_Heat Map"></center>
        
       
		<p> 
		
		<br>
		
		The following map shows the nationality that represents the missing climbers.<br> It is interesting to note that countries like china, India, USA has no missing records of climbers even 
		though they have significant number of death records.
		<br>
		</p>
		<iframe width="500" height="300" scrolling="no" frameborder="no" src="https://fusiontables.google.com/embedviz?q=select+col6+from+1buCnhkpiCY8d6YPsFQiu133jnjkzWLN1GGpxdchG&amp;viz=MAP&amp;h=false&amp;lat=30.49313326630948&amp;lng=96.27187400000004&amp;t=1&amp;z=2&amp;l=col6&amp;y=2&amp;tmplt=2&amp;hml=ONE_COL_LAT_LNG"></iframe>
	    <iframe width="500" height="300" scrolling="no" frameborder="no" src="https://fusiontables.google.com/embedviz?containerId=googft-gviz-canvas&amp;q=select+col6%2C+col2+from+1buCnhkpiCY8d6YPsFQiu133jnjkzWLN1GGpxdchG+order+by+col2+asc+limit+10&amp;viz=GVIZ&amp;t=PIE&amp;uiversion=2&amp;gco_forceIFrame=true&amp;gco_hasLabelsColumn=true&amp;width=500&amp;height=300"></iframe>
        
        
      	<p> 
      	<br>
      	
      	It can be seen from the chart below that the death count due to Avalanche is mostly in the summer months - April, May, June.<br>
      	From this dataset, we can even infer that avalance is common during the summer seasons and it is risky to climb especially in the month of April and September when the ice is more loose. </p> 
        <center><img width="650" height="250" src="/img/Byte_2_Image_2.png" alt="Avalance_Death V/s Month"></center>
        
      	<p> 
      	<br>
      	
      	The Method of Data Cleaning:<br>1. Export of primary data from google Fusion Table and represent it in wrangler <br>
      	<img width="650" height="250" src="/img/Byte_2_Image_1.png" alt="Raw Data-set"><br>
      	It can be seen from the image above that the 'age' column has most black colour, which indicates missing values.<br>
      	
      	<br>
      	2. Splitting of date from single format to Day, Month and Year <br>
      	<left><img width="500" height="250" src="/img/Byte_2_Image_4.png" alt="Cleaning_1.1"></left>
      	<right><img width="500" height="250" src="/img/Byte_2_Image_5.png" alt="Cleaning 1_2"></right><br>
      	
      	
      	<br>
      	3. For our first study: we have shorlisted only 'missing' terms in 'cause of death' column so that we have data where no death records have been registered 
      	<br>
      	
      	<br>
      	4. For our second study only the columns 'Month' , "nationality' and "avalanche" as 'cause of death' is selected so that we can relate which month has the most deaths by avalance<br>
      	<center><img width="500" height="250" src="/img/Byte_2_Image_6.png" alt="Cleaning 1_2"></center><br></p>
      	
      	<p>
      	<br>
      	The below table shows a part of the original tabulation of the data extracted from the fusion table
      	<br>
      	</p>
      	
      	
      	
      
      </div>
      
      <div class="page-header">
	
      </div> <!-- /page-header -->
    </div> <!-- /container -->
    
    
    <div class="button-toolbar" role="toolbar" id="headers" name="headers">
      {% for column in allheaders %}
      <button type="button" class = "btn-space btn btn-info" id="{{column}}" onclick="updateTable('{{column}}')">{{column}}</button>
      {% endfor %}
    </div>
    
    <div class="table-responsive">
	  <table class="table table-striped table-hover">
	    <thead class="thead-inverse">
	     <tr> 
	{% for item in headers %}
	         <th>{{ item }}</th>
	{% endfor %}
	     </tr>
	    </thead>
	    <tbody>
	{% for row in content %}
	     <tr>
	  {% for datum in row %}
	            <td>{{ datum }} </td>
	  {% endfor %}
	     </tr>
	{% endfor %}
	    </tbody>
	   </table>
	</div> 


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery-1.11.3.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script>
	function updateTable(str) {
		console.log("in updateTable");
		console.log(str);

	    // error checking: ignore buttons that don't have a title!
		if (str == "") {
			return;
		}

	    // find the actual button in this document's HTML
		button = document.getElementById(str);
		// for debugging, write its name to the console
		console.log(button.className);
		// check if it is disabled (btn-info)
		if (button.className.includes("btn-info")) {
			// and enable it (btn-primary)
			button.className = "btn btn-space btn-primary";
		} else {
			// otherwise disable it (btn-info)
			button.className = "btn btn-space btn-info";
		}

		// now get all the buttons
		buttons = document.getElementById("headers").children;
		// and collect their names in cols
		cols = [];
		// loop through them
		for (button in buttons) {
			// grab the id (the name we need is there)
			id = buttons[button].id;
			// make sure it isn't null
			if (buttons[button].id != null) {
				// and that the button is selected 
				var isPrimary = buttons[button].className.includes("btn-primary");
				if (isPrimary && (cols.indexOf(id) == -1)) {
					// if so, add it to our array
					cols.push(id);
				}
			}
		}
					
		$.ajax({
			url: '/_update_table',
			dataType: 'json',
			contentType: 'application/json',
			data: JSON.stringify({'cols' : cols}),
			type: 'POST',
			success: function (res, status) {
				console.log("successrunning");
				console.log(res["content"]);
				console.log(res["headers"]);
				var cols = res["headers"];
				var rows = res["content"];

				// get the table, columns and rows
				table = document.getElementById("data");
				headers = document.getElementById("cols");
				body = document.getElementById("rows");

				// delete current contents
				headers.innerHTML='';
				body.innerHTML = '';

				// and put the new information in the table
				for (col in cols) {
					cell = document.createElement("th");
					cell.innerHTML = cols[col];
					headers.appendChild(cell);
				}
				for (row in rows) {
					tr = document.createElement("tr");
					for (item in rows[row]) {
						td = document.createElement("td");
						td.innerHTML = rows[row][item];
						tr.appendChild(td);
					}
					body.appendChild(tr);
				}
			},
			error: function(res, status) {
				// On Error
				alert('error');
			}
		});
	}
				
				   
				   
</script>
</body>
</html>
